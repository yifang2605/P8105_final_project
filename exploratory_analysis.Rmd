---
title: "exploratory_analysis"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
theme_set(
  theme_minimal() + 
    theme(
      legend.position = "bottom",
      plot.title = element_text(hjust = 0.5)
    )  
)
```


read data

```{r}
nhis = 
  read_csv("data/nhis_data01.csv") %>% 
  janitor::clean_names()
```


## Worries and anxiety
number of people reported taken medication for worried, nervous, or anxious feeings from 2015 to 2021.
```{r}
nhis %>% 
  filter(
    year>=2015,
    worrx == 2
  ) %>% 
  group_by(year) %>% 
  summarize(wor_num = n()) %>% 
  ggplot(aes(x=year, y=wor_num))+
  geom_col()+
  scale_x_continuous(breaks = seq(2015, 2021, by = 1))+
  labs(
    title = "Number of people reporting taking medication for worry, stress or anxiety each year",
    x = "Year",
    y = "Number of people",
  )+
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

Frequency of worries
```{r}
nhis %>% 
  filter(
    year>=2015,
    worfreq > 0,
    worfreq < 7
  ) %>%
  mutate(
    worfreq = recode_factor(worfreq, '1' = "Daily", '2' = "Weekly", 
                            '3' = "Monthly", '4' = "A few times a year", 
                            '5' = "Never")
  ) %>% 
  group_by(year, worfreq) %>% 
  summarize(count = n()) %>% 
  ggplot(aes(fill=worfreq, x=year, y=count))+
  geom_bar(position="fill", stat="identity")+
  scale_x_continuous(breaks = seq(2015, 2021, by = 1))+
  labs(
    title = "Distribution of frequency of worries",
    x = "Year",
    y="Percentage",
    fill = "Frequency"
  )+
  theme(panel.grid = element_blank())
```

worry level distribution.
```{r}
nhis %>% 
  filter(
    year>=2015,
    worfeelevl > 0,
    worfeelevl < 7
  ) %>%
  mutate(
    worfeelevl = recode_factor(worfeelevl, '1' = "A lot", 
                               '3' = "Somewhere between a little and a lot", 
                               '2' = "A little")
  ) %>% 
  group_by(year, worfeelevl) %>% 
  summarize(count = n()) %>% 
  ggplot(aes(fill=worfeelevl, x=year, y=count))+
  geom_bar(position="fill", stat="identity")+
  scale_x_continuous(breaks = seq(2015, 2021, by = 1))+
  labs(
    title = "Distribution of worry levels",
    x = "Year",
    y="Percentage",
    fill = "Level"
  )+
  theme(panel.grid = element_blank())
```
